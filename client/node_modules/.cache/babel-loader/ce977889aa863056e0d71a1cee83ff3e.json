{"ast":null,"code":"import { fetchBaseQuery } from \"@reduxjs/toolkit/dist/query\";\nimport authApi from './authApi';\nconst baseQuery = fetchBaseQuery({\n  baseUrl: \"https://graph.microsoft.com/v1.0/users\"\n});\n\nconst baseQueryWithReauth = async (args, api, extra) => {\n  const {\n    error\n  } = await baseQuery(args, api, extra);\n\n  if (error && error.status === 401) {\n    //const result = await fetch('http://localhost:5001');\n    const {\n      isSuccess,\n      data\n    } = await api.dispatch(authApi.endpoints.getToken.initiate());\n    console.log(data);\n\n    if (isSuccess) {\n      console.log(extra);\n      return await baseQuery(args, api, extra);\n    }\n  }\n};\n\nexport default baseQueryWithReauth;","map":{"version":3,"names":["fetchBaseQuery","authApi","baseQuery","baseUrl","baseQueryWithReauth","args","api","extra","error","status","isSuccess","data","dispatch","endpoints","getToken","initiate","console","log"],"sources":["/Users/shahartamari/code/ad-org-tree/client/src/services/fetchWithReauth.js"],"sourcesContent":["import { fetchBaseQuery } from \"@reduxjs/toolkit/dist/query\";\n\nimport authApi from './authApi'\n\nconst baseQuery = fetchBaseQuery({\n  baseUrl: \"https://graph.microsoft.com/v1.0/users\",\n});\n\n\nconst baseQueryWithReauth = async (args, api, extra) => {\n  const {error} = await baseQuery(args, api, extra);\n  \n  if (error && error.status === 401) {\n    //const result = await fetch('http://localhost:5001');\n    const {isSuccess, data} = await api.dispatch(authApi.endpoints.getToken.initiate())\n    console.log (data);\n    if (isSuccess) {\n        console.log(extra);\n        return await baseQuery(args, api, extra)\n    }\n   \n  }\n};\n\nexport default baseQueryWithReauth;\n"],"mappings":"AAAA,SAASA,cAAT,QAA+B,6BAA/B;AAEA,OAAOC,OAAP,MAAoB,WAApB;AAEA,MAAMC,SAAS,GAAGF,cAAc,CAAC;EAC/BG,OAAO,EAAE;AADsB,CAAD,CAAhC;;AAKA,MAAMC,mBAAmB,GAAG,OAAOC,IAAP,EAAaC,GAAb,EAAkBC,KAAlB,KAA4B;EACtD,MAAM;IAACC;EAAD,IAAU,MAAMN,SAAS,CAACG,IAAD,EAAOC,GAAP,EAAYC,KAAZ,CAA/B;;EAEA,IAAIC,KAAK,IAAIA,KAAK,CAACC,MAAN,KAAiB,GAA9B,EAAmC;IACjC;IACA,MAAM;MAACC,SAAD;MAAYC;IAAZ,IAAoB,MAAML,GAAG,CAACM,QAAJ,CAAaX,OAAO,CAACY,SAAR,CAAkBC,QAAlB,CAA2BC,QAA3B,EAAb,CAAhC;IACAC,OAAO,CAACC,GAAR,CAAaN,IAAb;;IACA,IAAID,SAAJ,EAAe;MACXM,OAAO,CAACC,GAAR,CAAYV,KAAZ;MACA,OAAO,MAAML,SAAS,CAACG,IAAD,EAAOC,GAAP,EAAYC,KAAZ,CAAtB;IACH;EAEF;AACF,CAbD;;AAeA,eAAeH,mBAAf"},"metadata":{},"sourceType":"module"}