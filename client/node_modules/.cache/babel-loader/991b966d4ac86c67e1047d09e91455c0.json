{"ast":null,"code":"import { createApi, fetchBaseQuery } from \"@reduxjs/toolkit/query/react\";\nimport authApi from \"./authApi\";\nconst GRAPH_TYPE = \"GRAPH\";\nconst baseQuery = fetchBaseQuery({\n  baseUrl: \"https://graph.microsoft.com/beta/\"\n});\nconst graphApi = createApi({\n  reducerPath: \"MgGraph\",\n  baseQuery: fetchBaseQuery({\n    baseUrl: \"https://graph.microsoft.com/beta/\",\n    prepareHeaders: (headers, _ref) => {\n      let {\n        getState\n      } = _ref;\n      const token = authApi.endpoints.getToken.select()(getState());\n      console.log(token); //if (token) {\n      // headers.set(\"authorization\", `Bearer ${token}`);\n      // }\n\n      return headers;\n    }\n  }),\n  tagTypes: [GRAPH_TYPE],\n  endpoints: builder => ({\n    info: builder.query({\n      query: () => '/',\n\n      async onQueryStarted(undefined, _ref2) {\n        let {\n          dispatch,\n          getState,\n          queryFulfilled\n        } = _ref2;\n        const result = dispatch(authApi.endpoints.getToken.initiate());\n        await queryFulfilled;\n      }\n\n    }),\n    getUsers: builder.query({\n      query: () => \"users\"\n    }),\n    getUser: builder.query({\n      query: id => `users/${id}$select=displayName,jobTitle,department,userPrinicpalName`,\n      providesTags: (result, error, id) => [{\n        type: GRAPH_TYPE,\n        id\n      }]\n    })\n  })\n});\nexport default graphApi;\nexport const {\n  useGetUserQuery,\n  useGetUsersQuery,\n  useInfoQuery\n} = graphApi;","map":{"version":3,"names":["createApi","fetchBaseQuery","authApi","GRAPH_TYPE","baseQuery","baseUrl","graphApi","reducerPath","prepareHeaders","headers","getState","token","endpoints","getToken","select","console","log","tagTypes","builder","info","query","onQueryStarted","undefined","dispatch","queryFulfilled","result","initiate","getUsers","getUser","id","providesTags","error","type","useGetUserQuery","useGetUsersQuery","useInfoQuery"],"sources":["/Users/shahartamari/code/ad-org-tree/client/src/services/graphApi.js"],"sourcesContent":["import { createApi, fetchBaseQuery } from \"@reduxjs/toolkit/query/react\";\nimport authApi from \"./authApi\";\n\nconst GRAPH_TYPE = \"GRAPH\";\nconst baseQuery = fetchBaseQuery({\n  baseUrl: \"https://graph.microsoft.com/beta/\"});\n\nconst graphApi = createApi({\n  reducerPath: \"MgGraph\",\n  baseQuery: fetchBaseQuery({\n    baseUrl: \"https://graph.microsoft.com/beta/\",\n    prepareHeaders: (headers, { getState }) => {\n      \n    const token = authApi.endpoints.getToken.select()(getState());\n    console.log(token);\n      //if (token) {\n       // headers.set(\"authorization\", `Bearer ${token}`);\n     // }\n\n      return headers;\n    },\n  }),\n  tagTypes: [GRAPH_TYPE],\n  endpoints: (builder) => ({\n    info: builder.query ({\n      query: ()=> '/',\n      async onQueryStarted(undefined, {dispatch, getState, queryFulfilled}) {\n        const result = dispatch(authApi.endpoints.getToken.initiate())\n        await queryFulfilled;\n        \n      }\n    }),\n    getUsers: builder.query({\n      query: () => \"users\",\n    }),\n    getUser: builder.query({\n      query: (id) =>\n        `users/${id}$select=displayName,jobTitle,department,userPrinicpalName`,\n      providesTags: (result, error, id) => [{ type: GRAPH_TYPE, id }],\n    }),\n  }),\n});\n\nexport default graphApi;\nexport const { useGetUserQuery, useGetUsersQuery, useInfoQuery } = graphApi;\n\n"],"mappings":"AAAA,SAASA,SAAT,EAAoBC,cAApB,QAA0C,8BAA1C;AACA,OAAOC,OAAP,MAAoB,WAApB;AAEA,MAAMC,UAAU,GAAG,OAAnB;AACA,MAAMC,SAAS,GAAGH,cAAc,CAAC;EAC/BI,OAAO,EAAE;AADsB,CAAD,CAAhC;AAGA,MAAMC,QAAQ,GAAGN,SAAS,CAAC;EACzBO,WAAW,EAAE,SADY;EAEzBH,SAAS,EAAEH,cAAc,CAAC;IACxBI,OAAO,EAAE,mCADe;IAExBG,cAAc,EAAE,CAACC,OAAD,WAA2B;MAAA,IAAjB;QAAEC;MAAF,CAAiB;MAE3C,MAAMC,KAAK,GAAGT,OAAO,CAACU,SAAR,CAAkBC,QAAlB,CAA2BC,MAA3B,GAAoCJ,QAAQ,EAA5C,CAAd;MACAK,OAAO,CAACC,GAAR,CAAYL,KAAZ,EAH2C,CAIzC;MACC;MACF;;MAEC,OAAOF,OAAP;IACD;EAXuB,CAAD,CAFA;EAezBQ,QAAQ,EAAE,CAACd,UAAD,CAfe;EAgBzBS,SAAS,EAAGM,OAAD,KAAc;IACvBC,IAAI,EAAED,OAAO,CAACE,KAAR,CAAe;MACnBA,KAAK,EAAE,MAAK,GADO;;MAEnB,MAAMC,cAAN,CAAqBC,SAArB,SAAsE;QAAA,IAAtC;UAACC,QAAD;UAAWb,QAAX;UAAqBc;QAArB,CAAsC;QACpE,MAAMC,MAAM,GAAGF,QAAQ,CAACrB,OAAO,CAACU,SAAR,CAAkBC,QAAlB,CAA2Ba,QAA3B,EAAD,CAAvB;QACA,MAAMF,cAAN;MAED;;IANkB,CAAf,CADiB;IASvBG,QAAQ,EAAET,OAAO,CAACE,KAAR,CAAc;MACtBA,KAAK,EAAE,MAAM;IADS,CAAd,CATa;IAYvBQ,OAAO,EAAEV,OAAO,CAACE,KAAR,CAAc;MACrBA,KAAK,EAAGS,EAAD,IACJ,SAAQA,EAAG,2DAFO;MAGrBC,YAAY,EAAE,CAACL,MAAD,EAASM,KAAT,EAAgBF,EAAhB,KAAuB,CAAC;QAAEG,IAAI,EAAE7B,UAAR;QAAoB0B;MAApB,CAAD;IAHhB,CAAd;EAZc,CAAd;AAhBc,CAAD,CAA1B;AAoCA,eAAevB,QAAf;AACA,OAAO,MAAM;EAAE2B,eAAF;EAAmBC,gBAAnB;EAAqCC;AAArC,IAAsD7B,QAA5D"},"metadata":{},"sourceType":"module"}