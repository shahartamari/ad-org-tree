{"ast":null,"code":"import { fetchBaseQuery } from \"@reduxjs/toolkit/dist/query\";\nimport { setToken } from \"./authSlice\";\nconst baseQuery = fetchBaseQuery({\n  baseUrl: \"https://graph.microsoft.com/v1.0/users\"\n});\nconst authQuery = fetchBaseQuery({\n  baseUrl: \"http://localhost:5001/\"\n});\n\nconst baseQueryWithReauth = async (args, api, extra) => {\n  const {\n    error\n  } = await baseQuery(args, api, extra);\n  console.log(result);\n\n  if (error && result.error.status === 401) {\n    const result = await authQuery();\n\n    if (result.data) {\n      api.dispatch(setToken(result.data));\n      return baseQuery(args, api, extra);\n    }\n  }\n};\n\nexport default baseQueryWithReauth;","map":{"version":3,"names":["fetchBaseQuery","setToken","baseQuery","baseUrl","authQuery","baseQueryWithReauth","args","api","extra","error","console","log","result","status","data","dispatch"],"sources":["/Users/shahartamari/code/ad-org-tree/client/src/services/fetchWithReauth.js"],"sourcesContent":["import { fetchBaseQuery } from \"@reduxjs/toolkit/dist/query\";\nimport { setToken } from \"./authSlice\";\n\nconst baseQuery = fetchBaseQuery({\n  baseUrl: \"https://graph.microsoft.com/v1.0/users\",\n});\n\nconst authQuery = fetchBaseQuery({ baseUrl: \"http://localhost:5001/\" });\n\nconst baseQueryWithReauth = async (args, api, extra) => {\n  const {error} = await baseQuery(args, api, extra);\n  console.log(result);\n  if (error && result.error.status === 401) {\n   \n    const result = await authQuery();\n    if (result.data) {\n      api.dispatch(setToken(result.data));\n      return baseQuery(args, api, extra);\n    }\n  }\n};\n\nexport default baseQueryWithReauth;\n"],"mappings":"AAAA,SAASA,cAAT,QAA+B,6BAA/B;AACA,SAASC,QAAT,QAAyB,aAAzB;AAEA,MAAMC,SAAS,GAAGF,cAAc,CAAC;EAC/BG,OAAO,EAAE;AADsB,CAAD,CAAhC;AAIA,MAAMC,SAAS,GAAGJ,cAAc,CAAC;EAAEG,OAAO,EAAE;AAAX,CAAD,CAAhC;;AAEA,MAAME,mBAAmB,GAAG,OAAOC,IAAP,EAAaC,GAAb,EAAkBC,KAAlB,KAA4B;EACtD,MAAM;IAACC;EAAD,IAAU,MAAMP,SAAS,CAACI,IAAD,EAAOC,GAAP,EAAYC,KAAZ,CAA/B;EACAE,OAAO,CAACC,GAAR,CAAYC,MAAZ;;EACA,IAAIH,KAAK,IAAIG,MAAM,CAACH,KAAP,CAAaI,MAAb,KAAwB,GAArC,EAA0C;IAExC,MAAMD,MAAM,GAAG,MAAMR,SAAS,EAA9B;;IACA,IAAIQ,MAAM,CAACE,IAAX,EAAiB;MACfP,GAAG,CAACQ,QAAJ,CAAad,QAAQ,CAACW,MAAM,CAACE,IAAR,CAArB;MACA,OAAOZ,SAAS,CAACI,IAAD,EAAOC,GAAP,EAAYC,KAAZ,CAAhB;IACD;EACF;AACF,CAXD;;AAaA,eAAeH,mBAAf"},"metadata":{},"sourceType":"module"}